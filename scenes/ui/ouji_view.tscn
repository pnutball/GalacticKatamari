[gd_scene load_steps=58 format=3 uid="uid://bfk4h2p6ortti"]

[ext_resource type="Script" path="res://scripts/ouji_view.gd" id="1_g71is"]
[ext_resource type="Texture2D" uid="uid://dxiw044rvr1po" path="res://assets/textures/ui/earth.png" id="3_w4j5m"]

[sub_resource type="Environment" id="Environment_d2jpm"]
ambient_light_source = 2
ambient_light_color = Color(1, 1, 1, 1)

[sub_resource type="World3D" id="World3D_kidyq"]
environment = SubResource("Environment_d2jpm")

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_7b822"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ptnkm"]
animation = &"Ouji_Climb"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pqmwy"]
animation = &"Ouji_Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1gu1e"]
animation = &"Ouji_Roll_Backward"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_6t0l6"]
animation = &"Ouji_Roll_Forward"

[sub_resource type="AnimationNodeAdd2" id="AnimationNodeAdd2_56pxy"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_grhpb"]
animation = &"Internal_OujiRootTurn"

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_tvb7u"]
graph_offset = Vector2(-229.584, -160)
nodes/Forward/node = SubResource("AnimationNodeAnimation_6t0l6")
nodes/Forward/position = Vector2(-40, 140)
nodes/OujiForwardAdd/node = SubResource("AnimationNodeAdd2_56pxy")
nodes/OujiForwardAdd/position = Vector2(180, 180)
nodes/Turn/node = SubResource("AnimationNodeAnimation_grhpb")
nodes/Turn/position = Vector2(-100, 320)
nodes/output/position = Vector2(380, 180)
node_connections = [&"OujiForwardAdd", 0, &"Forward", &"OujiForwardAdd", 1, &"Turn", &"output", 0, &"OujiForwardAdd"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_33bl7"]
animation = &"Ouji_Roll_Left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ipqxi"]
animation = &"Ouji_Roll_Right"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_cxbke"]
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x >= 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_r0gw6"]
switch_mode = 1
advance_mode = 2
advance_condition = &"backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_vy1ni"]
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tywnn"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x >= 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gafef"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_addj7"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_nyvk3"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7c1fb"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_y83c1"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x >= 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_mr223"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"forward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yggki"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ckqgm"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"forward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_il8yv"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x >= 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_rx1eu"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"forward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xk25a"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"side_condition"
advance_expression = "StickMidpoint.x < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xny26"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"forward_condition"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_a1aq2"]
states/Backward/node = SubResource("AnimationNodeAnimation_1gu1e")
states/Backward/position = Vector2(606, 579)
states/End/position = Vector2(1074, 47)
states/Forward/node = SubResource("AnimationNodeBlendTree_tvb7u")
states/Forward/position = Vector2(594, 54.0366)
states/Left/node = SubResource("AnimationNodeAnimation_33bl7")
states/Left/position = Vector2(260, 358)
states/Right/node = SubResource("AnimationNodeAnimation_ipqxi")
states/Right/position = Vector2(953, 345)
states/Start/position = Vector2(699, 422)
transitions = ["Start", "Right", SubResource("AnimationNodeStateMachineTransition_cxbke"), "Start", "Backward", SubResource("AnimationNodeStateMachineTransition_r0gw6"), "Start", "Left", SubResource("AnimationNodeStateMachineTransition_vy1ni"), "Backward", "Right", SubResource("AnimationNodeStateMachineTransition_tywnn"), "Right", "Backward", SubResource("AnimationNodeStateMachineTransition_gafef"), "Backward", "Left", SubResource("AnimationNodeStateMachineTransition_addj7"), "Left", "Backward", SubResource("AnimationNodeStateMachineTransition_nyvk3"), "Right", "Left", SubResource("AnimationNodeStateMachineTransition_7c1fb"), "Left", "Right", SubResource("AnimationNodeStateMachineTransition_y83c1"), "Start", "Forward", SubResource("AnimationNodeStateMachineTransition_mr223"), "Forward", "Backward", SubResource("AnimationNodeStateMachineTransition_yggki"), "Backward", "Forward", SubResource("AnimationNodeStateMachineTransition_ckqgm"), "Forward", "Right", SubResource("AnimationNodeStateMachineTransition_il8yv"), "Right", "Forward", SubResource("AnimationNodeStateMachineTransition_rx1eu"), "Forward", "Left", SubResource("AnimationNodeStateMachineTransition_xk25a"), "Left", "Forward", SubResource("AnimationNodeStateMachineTransition_xny26")]
graph_offset = Vector2(91.3457, 273.086)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lqhe6"]
animation = &"Ouji_Walk_Backward"

[sub_resource type="AnimationNodeAdd2" id="AnimationNodeAdd2_xswc2"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_upmdm"]
animation = &"Internal_OujiRootTurn"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fdt3x"]
animation = &"Ouji_Walk_Forward"

[sub_resource type="AnimationNodeAdd2" id="AnimationNodeAdd2_i7hyg"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5xi1e"]
animation = &"Internal_OujiHeadTurn"

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_1xryl"]
graph_offset = Vector2(-486.454, -38.4049)
nodes/BodyRotAdd/node = SubResource("AnimationNodeAdd2_xswc2")
nodes/BodyRotAdd/position = Vector2(-160, 80)
nodes/BodyTurn/node = SubResource("AnimationNodeAnimation_upmdm")
nodes/BodyTurn/position = Vector2(-400, 340)
nodes/Forward/node = SubResource("AnimationNodeAnimation_fdt3x")
nodes/Forward/position = Vector2(-400, 80)
nodes/HeadRotAdd/node = SubResource("AnimationNodeAdd2_i7hyg")
nodes/HeadRotAdd/position = Vector2(20, 80)
nodes/HeadTurn/node = SubResource("AnimationNodeAnimation_5xi1e")
nodes/HeadTurn/position = Vector2(-400, 220)
nodes/output/position = Vector2(200, 80)
node_connections = [&"BodyRotAdd", 0, &"Forward", &"BodyRotAdd", 1, &"HeadTurn", &"HeadRotAdd", 0, &"BodyRotAdd", &"HeadRotAdd", 1, &"BodyTurn", &"output", 0, &"HeadRotAdd"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bxri2"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"not_backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_i4n0w"]
xfade_time = 0.2
priority = 2
switch_mode = 1
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ophtt"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"backward_condition"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_g4tut"]
xfade_time = 0.2
switch_mode = 1
advance_mode = 2
advance_condition = &"not_backward_condition"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_3vv05"]
states/Backward/node = SubResource("AnimationNodeAnimation_lqhe6")
states/Backward/position = Vector2(377, 143.389)
states/Forward/node = SubResource("AnimationNodeBlendTree_1xryl")
states/Forward/position = Vector2(377, 53.3886)
transitions = ["Start", "Forward", SubResource("AnimationNodeStateMachineTransition_bxri2"), "Start", "Backward", SubResource("AnimationNodeStateMachineTransition_i4n0w"), "Forward", "Backward", SubResource("AnimationNodeStateMachineTransition_ophtt"), "Backward", "Forward", SubResource("AnimationNodeStateMachineTransition_g4tut")]
graph_offset = Vector2(0, -12.7141)

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_m8qfg"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"walk_speed_reached"
advance_expression = "not is_zero_approx(StickMidpoint.length())"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_27yf4"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"idle_speed_reached"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3p50r"]
xfade_time = 0.2
reset = false
switch_mode = 1
advance_mode = 2
advance_expression = "is_zero_approx(StickMidpoint.length())"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_wvdnn"]
xfade_time = 0.2
reset = false
switch_mode = 1
advance_mode = 2
advance_expression = "not is_zero_approx(StickMidpoint.length())"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xh258"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"walk_speed_reached"
advance_expression = "is_zero_approx(StickMidpoint.length())"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_73w21"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"idle_speed_reached"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kabmr"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ct57w"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "Climbing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_toiim"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "not is_zero_approx(StickMidpoint.length()) and not Climbing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bjkcn"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "is_zero_approx(StickMidpoint.length()) and not Climbing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_e5b03"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "Climbing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_cvxrq"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "Climbing"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_lygbi"]
states/Ouji_Climb/node = SubResource("AnimationNodeAnimation_ptnkm")
states/Ouji_Climb/position = Vector2(732.047, 115.132)
states/Ouji_Idle/node = SubResource("AnimationNodeAnimation_pqmwy")
states/Ouji_Idle/position = Vector2(314, 100)
states/Ouji_Roll/node = SubResource("AnimationNodeStateMachine_a1aq2")
states/Ouji_Roll/position = Vector2(520.047, 68)
states/Ouji_Walk/node = SubResource("AnimationNodeStateMachine_3vv05")
states/Ouji_Walk/position = Vector2(520.047, 155)
states/Start/position = Vector2(158, 90)
transitions = ["Ouji_Idle", "Ouji_Roll", SubResource("AnimationNodeStateMachineTransition_m8qfg"), "Ouji_Roll", "Ouji_Idle", SubResource("AnimationNodeStateMachineTransition_27yf4"), "Ouji_Roll", "Ouji_Walk", SubResource("AnimationNodeStateMachineTransition_3p50r"), "Ouji_Walk", "Ouji_Roll", SubResource("AnimationNodeStateMachineTransition_wvdnn"), "Ouji_Idle", "Ouji_Walk", SubResource("AnimationNodeStateMachineTransition_xh258"), "Ouji_Walk", "Ouji_Idle", SubResource("AnimationNodeStateMachineTransition_73w21"), "Start", "Ouji_Idle", SubResource("AnimationNodeStateMachineTransition_kabmr"), "Ouji_Idle", "Ouji_Climb", SubResource("AnimationNodeStateMachineTransition_ct57w"), "Ouji_Climb", "Ouji_Roll", SubResource("AnimationNodeStateMachineTransition_toiim"), "Ouji_Climb", "Ouji_Walk", SubResource("AnimationNodeStateMachineTransition_bjkcn"), "Ouji_Roll", "Ouji_Climb", SubResource("AnimationNodeStateMachineTransition_e5b03"), "Ouji_Walk", "Ouji_Climb", SubResource("AnimationNodeStateMachineTransition_cvxrq")]
graph_offset = Vector2(93.0474, 12.1325)

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_5ly86"]
graph_offset = Vector2(-181.105, 21.0155)
nodes/MovementScale/node = SubResource("AnimationNodeTimeScale_7b822")
nodes/MovementScale/position = Vector2(580, 60)
nodes/WalkState/node = SubResource("AnimationNodeStateMachine_lygbi")
nodes/WalkState/position = Vector2(400, 100)
nodes/output/position = Vector2(780, 60)
node_connections = [&"MovementScale", 0, &"WalkState", &"output", 0, &"MovementScale"]

[node name="OujiView" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_g71is")

[node name="OujiViewportContainer" type="SubViewportContainer" parent="."]
layout_mode = 1
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -665.0
offset_top = -1080.0
offset_right = -25.0
grow_horizontal = 0
grow_vertical = 0
stretch = true

[node name="SubViewport" type="SubViewport" parent="OujiViewportContainer"]
own_world_3d = true
world_3d = SubResource("World3D_kidyq")
transparent_bg = true
handle_input_locally = false
msaa_3d = 3
size = Vector2i(640, 1080)
render_target_update_mode = 4

[node name="Camera3D" type="Camera3D" parent="OujiViewportContainer/SubViewport"]
transform = Transform3D(0.848048, 0.0369653, 0.528628, 0, 0.997564, -0.0697565, -0.529919, 0.0591568, 0.845982, 1.915, 0.17, 2.415)
fov = 35.9

[node name="OujiAnimTree" type="AnimationTree" parent="OujiViewportContainer/SubViewport"]
unique_name_in_owner = true
active = false
tree_root = SubResource("AnimationNodeBlendTree_5ly86")
advance_expression_base_node = NodePath("../../../..")
parameters/MovementScale/scale = 1.0
parameters/WalkState/conditions/idle_speed_reached = false
parameters/WalkState/conditions/walk_speed_reached = false
parameters/WalkState/Ouji_Roll/conditions/backward_condition = false
parameters/WalkState/Ouji_Roll/conditions/forward_condition = false
parameters/WalkState/Ouji_Roll/conditions/side_condition = false
parameters/WalkState/Ouji_Roll/Forward/OujiForwardAdd/add_amount = 0
parameters/WalkState/Ouji_Walk/conditions/backward_condition = false
parameters/WalkState/Ouji_Walk/conditions/not_backward_condition = false
parameters/WalkState/Ouji_Walk/Forward/BodyRotAdd/add_amount = 0
parameters/WalkState/Ouji_Walk/Forward/HeadRotAdd/add_amount = 0

[node name="OujiViewBG" type="TextureRect" parent="."]
z_index = -1
layout_mode = 1
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -432.0
offset_top = -306.0
grow_horizontal = 0
grow_vertical = 0
texture = ExtResource("3_w4j5m")
expand_mode = 2
stretch_mode = 4
